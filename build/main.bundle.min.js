"use strict"
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t)
e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bindInputHandler(){document.onkeydown=function(e){37==e.keyCode&&(player.isLeft=!0),38==e.keyCode&&(player.isUp=!0),39==e.keyCode&&(player.isRight=!0),40==e.keyCode&&(player.isDown=!0)},document.onkeyup=function(e){37==e.keyCode&&(player.isLeft=!1),38==e.keyCode&&(player.isUp=!1),39==e.keyCode&&(player.isRight=!1),40==e.keyCode&&(player.isDown=!1)}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t)
e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),AnimatedTerrain=function(e){function t(e,i,n){_classCallCheck(this,t)
var s=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n))
return s.dt=120,s.cf=0,s.maxcf=3,s.loop=setInterval(function(){s.cf>s.maxcf?s.cf=0:s.cf++},s.dt),s}return _inherits(t,e),_createClass(t,[{key:"draw",value:function(){Renderer.drawImage(MapKey[this.key],0,0,this.w,this.h,this.x,this.y,this.w,this.h)}}]),t}(Terrain),_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),AssetManager=function(){function e(){_classCallCheck(this,e),this.isLoaded=!1}return _createClass(e,[{key:"loadAssets",value:function(){var e=this
console.log("loading assets...")
Date.now()
try{var t=[]
t[0]=mec_default.load(),t[1]=player.load()
for(var i=["","src/assets/map/grass.png","src/assets/map/wall.png"],n=[!0,!0,!1],s=0;s<i.length;s++)MapKey[s]=new Key,t[s+2]=MapKey[s].load(i[s],n[s])
Promise.all(t).then(function(t){console.log("loaded assets: "+t.reduce(function(e,t){return e+t},0)+" ms"),e.isLoaded=!0}).catch(function(){throw new Error("LOADING ERROR: could not load assets")}),this.isLoaded=!0}catch(e){console.log(e),this.isLoaded=!1}}}]),e}(),_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),AudioManager=function(){function e(){_classCallCheck(this,e),this.sounds={0:new Audio("src/assets/audio/sounds/grenade.mp3")},this.music={0:new Audio("src/assets/audio/music/menu.mp3"),1:new Audio("src/assets/audio/music/heman.mp3")},this.activeMusic=[]}return _createClass(e,[{key:"playMusic",value:function(e){var t=this.getAudioTrack(1,e)
4==t.readyState?-1==this.activeMusic.toString().indexOf(e)&&(t.play(),this.activeMusic.push(e)):console.log("Audio ("+e+") is not ready yet! Cannot play!")}},{key:"pauseMusic",value:function(e){var t=this.getAudioTrack(1,e)
this.music
if(4==t.readyState){t.pause()
for(var i=0;i<this.activeMusic.length;i++)this.activeMusic[i]==e&&this.activeMusic.splice(i,1)}else console.log("Audio ("+e+") is not ready yet! Cannot pause!")}},{key:"stopAllMusic",value:function(){for(var e=void 0,t=0;t<this.activeMusic.length;t++)e=this.getAudioTrack(1,this.activeMusic[t]),e.pause(),e.currentTime=0}},{key:"getAudioTrack",value:function(e,t){var i="",n=0==e?this.sounds:this.music
t=t.toLowerCase()
for(var s=0;s<Object.keys(n).length;s++)if(i=n[s].src.substring(n[s].src.lastIndexOf("/")+1),0==i.indexOf(t))return n[s]
return console.log('Game music file not found for "'+t+'".'),n[0]}}]),e}(),Camera=_defineProperty({zoom:1,x:0,y:0,xbias:0,ybias:0,oldscale:1,move:function(e,t){Camera.x=e+Camera.xbias,Camera.y=t+Camera.ybias},translate:function(e,t){Camera.x+=e,Camera.y+=t}},"zoom",function(e,t,i){ctx.scale(e,e)
var n=e-Camera.oldscale
console.log(n),Camera.xbias=t*n,Camera.ybias=i*n}),Constants={GROUP_PLAYER:1,GROUP_WALL:2,GROUP_ENEMY:4},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Game=function(){function e(t,i){_classCallCheck(this,e),this.assetmanager=new AssetManager,this.screen_width=t,this.screen_height=i,this.enemy_melee=[],this.walls=[],this.enemy_melee.push(new MeleeEnemy(-600,-200,30)),this.enemy_melee.push(new MeleeEnemy(-300,-800,30)),this.enemy_melee.push(new MeleeEnemy(900,-300,30)),this.enemy_melee.push(new MeleeEnemy(-500,400,30)),this.world=new p2.World({gravity:[0,0]}),this.world.on("beginContact",function(e){e.shapeA}),this.states=Object.freeze({PLAYING:0,MENU:1}),this.isPlaying=!1,this.timeStep=1/60}return _createClass(e,[{key:"init",value:function(){this.assetmanager.loadAssets(),this.generateMap(),this.addBodies()}},{key:"start",value:function(){var e=this
this.init(),this.load=setInterval(function(){e.isReady()&&(e.isPlaying=!0,clearInterval(e.load),bindInputHandler(),e.currentstate=e.states.PLAYING,window.requestAnimationFrame(function(){e.update()}))},50)}},{key:"update",value:function(){var e=this
if(this.currentstate==this.states.PLAYING){this.world.step(this.timeStep),player.update(this.dt)
for(var t=0;t<this.enemy_melee.length;t++)this.enemy_melee[t].update(this.dt)
Camera.move(player.x-this.screen_width/2+player.getWidth()/2,player.y-this.screen_height/2+player.getHeight()/2),player.x>400?audio.pauseMusic("heman"):audio.playMusic("heman"),this.render(),this.isPlaying&&window.requestAnimationFrame(function(){e.update()})}}},{key:"render",value:function(){this.dt=Date.now()-this.render_previous,this.render_previous=Date.now(),e.clearScreen()
for(var t=0;t<this.map.length;t++)for(var i=0;i<this.map[t].length;i++)void 0!=this.map[t][i]&&this.map[t][i].draw()
player.draw(),player.drawBoundingBox(),Renderer.fillText("(0, 0)",0,0,100)
for(var n=0;n<this.enemy_melee.length;n++)this.enemy_melee[n].draw(),this.enemy_melee[n].drawBoundingBox()
for(var s=0;s<this.walls.length;s++)this.walls[s].draw()
this.render_end=Date.now()}},{key:"isReady",value:function(){if(this.assetmanager.isLoaded)return!0}},{key:"addBodies",value:function(){this.world.addBody(player.body)
for(var e=0;e<this.map.length;e++)for(var t=0;t<this.map[e].length;t++)void 0!=this.map[e][t]&&(0==this.map[e][t].key&&(player.setX(this.map[e][t].x),player.setY(this.map[e][t].y)),this.map[e][t]instanceof Wall&&this.world.addBody(this.map[e][t].body))
for(var i=0;i<this.enemy_melee.length;i++)this.world.addBody(this.enemy_melee[i].body)}},{key:"generateMap",value:function(){var e=[[2,2,2,2],[2,1,2,2],[1,1,2,2],[1,1,1,1],[1,1,1,1],[1,1,1,1]],t=[[0,1,1,1],[1,1,1,1],[1,1,0,1],[1,1,1,1]]
MapGenerator.appendChunk(e,t,0),this.map=MapGenerator.generate(e)}}],[{key:"clearScreen",value:function(){ctx.clearRect(0,0,canvas.width,canvas.height)}}]),e}(),canvas=void 0,canvas_map=void 0,ctx=void 0,ctx_map=void 0,player=void 0,game=void 0,audio=void 0
$(document).ready(function(){canvas=document.getElementById("main_canvas"),ctx=document.getElementById("main_canvas").getContext("2d"),ctx.font="14px Verdana",canvas.width=$(window).width(),canvas.height=$(window).height(),$("body").css("overflow","hidden"),audio=new AudioManager,game=new Game($(window).width(),$(window).height()),player=new Player(10,0,5.5),game.start()})
var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Key=function(){function e(){_classCallCheck(this,e),this.img=new Image}return _createClass(e,[{key:"load",value:function(e,t){var i=this,n=Date.now()
return this.img.src=e||"src/assets/img/img_null.png",this.isTerrain=t,new Promise(function(e,t){i.img.onload=function(){e(Date.now()-n)},i.img.onerror=function(){t()}})}}]),e}()
MapKey=[]
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}()
MapConstants={TILE_WIDTH:66,TILE_HEIGHT:66,x:0,y:0}
var MapGenerator=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"generate",value:function(e,t){for(var i=[e.length],n=0;n<e.length;n++)i.push(new Array(e[n].length))
i.shift(),console.log("generating "+e.length+" x "+e[0].length+" map...")
for(var s=0;s<e.length;s++)for(var a=0;a<e[s].length;a++)try{if(void 0==e[s][a]||void 0==_typeof(e[s][a]))continue
MapKey[e[s][a]].isTerrain?i[s][a]=new Terrain(e[s][a],a*MapConstants.TILE_WIDTH+MapConstants.x,s*MapConstants.TILE_HEIGHT+MapConstants.y):i[s][a]=new Wall(e[s][a],a*MapConstants.TILE_WIDTH+MapConstants.x,s*MapConstants.TILE_HEIGHT+MapConstants.y,MapConstants.TILE_WIDTH,MapConstants.TILE_HEIGHT)}catch(e){e instanceof TypeError&&console.log("rdeg")}return i}},{key:"appendChunk",value:function(e,t,i){for(var n=0;n<e.length;n++)e[n+i]=e[n+i].concat(t[n])}},{key:"pushChunk",value:function(e,t,i){if(i<0)throw new Error("pushChunk() cannot take a negative collumn index")
for(var n=0;n<t.length;n++)if(i>0){for(var s=[],a=0;a<i;a++)s[a]=void 0
s=s.concat(t[n]),e.push(s)}else e.push(t[n])
return e}}]),e}(),_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Player=function(){function e(t,i,n){_classCallCheck(this,e),this.spr_width=460.25,this.spr_height=592,this.cf=3,this.maxcf=4,this.dt=100,this.dt_max=75,this.dt_count=0,this.img=new Image,this.isLeft=!1,this.isRight=!1,this.isDown=!1,this.isUp=!1,this.leftY=1184,this.rightY=592,this.downY=0,this.upY=1846,this.previousY=0,this.spd=n,this.velocity_spd=3.3,this.velocity_start=55,this.velocity_max=100,this.velocity_decay=8*this.velocity_spd,this.body=new p2.Body({position:[t,i],mass:1,type:p2.Body.DYNAMIC}),this.shape=new p2.Box({width:64,height:64,collisionGroup:Constants.GROUP_PLAYER,collisionMask:Constants.GROUP_ENEMY|Constants.GROUP_WALL}),this.body.addShape(this.shape)}return _createClass(e,[{key:"load",value:function(){var e=this
return new Promise(function(t,i){var n=Date.now()
e.img.src="src/assets/spritesheets/SpriteSheet.png",e.img.onload=function(){t(Date.now()-n)},e.img.onerror=function(){i()}})}},{key:"getKeyFrame",value:function(){return this.isLeft?(this.previousY=this.leftY,this.leftY):this.isRight?(this.previousY=this.rightY,this.rightY):this.isUp?(this.previousY=this.upY,this.upY):this.isDown?(this.previousY=this.downY,this.downY):this.previousY}},{key:"update",value:function(e){this.dt_count=(e||1/60)+(this.dt_count||0),this.dt_count>=this.dt&&(this.cf++,this.dt_count=0),this.cf>=this.maxcf?this.cf=0:this.isLeft||this.isUp||this.isDown||this.isRight||(this.cf=0),this.isLeft&&Math.abs(this.body.velocity[0])<this.velocity_max&&(this.velocity[0]>-this.velocity_start&&this.setXVelocity(-this.velocity_start),this.body.velocity[0]-=this.velocity_spd),!this.isLeft&&this.body.velocity[0]<0&&(this.body.velocity[0]/=this.velocity_decay),this.isRight&&this.body.velocity[0]<this.velocity_max&&(this.velocity[0]<this.velocity_start&&this.setXVelocity(this.velocity_start),this.body.velocity[0]+=this.velocity_spd),!this.isRight&&this.body.velocity[0]>0&&(this.body.velocity[0]/=this.velocity_decay),this.isDown&&this.body.velocity[1]<this.velocity_max&&(this.velocity[1]<this.velocity_start&&this.setYVelocity(this.velocity_start),this.body.velocity[1]+=this.velocity_spd),!this.isDown&&this.body.velocity[1]>0&&(this.body.velocity[1]/=this.velocity_decay),this.isUp&&Math.abs(this.body.velocity[1])<this.velocity_max&&(this.velocity[1]>-this.velocity_start&&this.setYVelocity(-this.velocity_start),this.body.velocity[1]-=this.velocity_spd),!this.isUp&&this.body.velocity[1]<0&&(this.body.velocity[1]/=this.velocity_decay)}},{key:"draw",value:function(){Renderer.drawBoxImage(this.img,this.shape,this.spr_width*this.cf,this.getKeyFrame(),this.spr_width,this.spr_height,this.x,this.y,this.getWidth(),this.getHeight())}},{key:"drawBoundingBox",value:function(){Renderer.drawShapeBoundingBox(this.shape,this.x,this.y,this.getWidth(),this.getHeight())}},{key:"setYVelocity",value:function(e){this.velocity[1]=e}},{key:"setXVelocity",value:function(e){this.velocity[0]=e}},{key:"setX",value:function(e){this.body.position[0]=e}},{key:"setY",value:function(e){this.body.position[1]=e}},{key:"getWidth",value:function(){return this.shape.width}},{key:"getHeight",value:function(){return this.shape.height}},{key:"setWidth",value:function(e){this.shape.width=e}},{key:"setHeight",value:function(e){this.shape.height=e}},{key:"velocity",get:function(){return this.body.velocity}},{key:"x",get:function(){return this.body.position[0]}},{key:"y",get:function(){return this.body.position[1]}}]),e}(),_Renderer,Renderer=(_Renderer={drawImage:function(e,t,i,n,s,a,o,r,c){ctx.drawImage(e,t,i,n,s,a-Camera.x,o-Camera.y,r,c)},fillRect:function(e,t,i,n){ctx.fillRect(e-Camera.x,t-Camera.y,i,n)},fillBoxRect:function(e,t,i,n,s){ctx.fillRect(t-Camera.x-e.width/2,i-Camera.y-e.height/2,n,s)},rect:function(e,t,i,n){ctx.strokeRect(e-Camera.x,t-Camera.y,i,n)},fillText:function(e,t,i,n){ctx.fillText(e,t-Camera.x,i-Camera.y,n)}},_defineProperty(_Renderer,"fillText",function(e,t,i){ctx.fillText(e,t-Camera.x,i-Camera.y)}),_defineProperty(_Renderer,"drawBoxImage",function(e,t,i,n,s,a,o,r,c,h){ctx.drawImage(e,i,n,s,a,o-Camera.x-t.width/2,r-Camera.y-t.height/2,c,h)}),_defineProperty(_Renderer,"drawShapeBoundingBox",function(e,t,i,n,s){ctx.strokeStyle="green",ctx.strokeRect(t-Camera.x-e.width/2,i-Camera.y-e.height/2,n,s)}),_defineProperty(_Renderer,"drawPositionBox",function(e,t,i,n){ctx.font=e,ctx.fillText("("+(i-Camera.x-t.width/2)+", "+(n-Camera.y-t.height/2)+")",i-Camera.x-t.width/2,n-Camera.y-t.height/2)}),_Renderer)
window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||!1
var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Terrain=function(){function e(t,i,n){_classCallCheck(this,e),this.key=t,this.x=i,this.y=n}return _createClass(e,[{key:"draw",value:function(){Renderer.drawImage(MapKey[this.key].img,0,0,64,64,this.x-32,this.y-32,64,64)}}]),e}(),_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Wall=function(){function e(t,i,n,s,a){_classCallCheck(this,e),this.key=t,this.body=new p2.Body({position:[i,n],type:p2.Body.STATIC}),this.shape=new p2.Box({width:s,height:a,collisionGroup:Constants.GROUP_WALL,collisionMask:Constants.GROUP_ENEMY|Constants.GROUP_PLAYER}),this.body.addShape(this.shape)}return _createClass(e,[{key:"update",value:function(){}},{key:"draw",value:function(){Renderer.drawBoxImage(MapKey[this.key].img,this.shape,0,0,this.width,this.height,this.x,this.y,this.width,this.width)}},{key:"setX",value:function(e){this.body.position[0]=e}},{key:"setY",value:function(e){this.body.position[1]=e}},{key:"setWidth",value:function(e){this.shape.width=e}},{key:"setHeight",value:function(e){this.shape.height=e}},{key:"x",get:function(){return this.body.position[0]}},{key:"y",get:function(){return this.body.position[1]}},{key:"height",get:function(){return this.shape.width}},{key:"width",get:function(){return this.shape.height}}]),e}(),Enemy=function e(){_classCallCheck(this,e)},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),MeleeEnemyConstants=function(){function e(){_classCallCheck(this,e),this.leftY=64,this.rightY=192,this.upY=0,this.downY=128,this.spr_width=64,this.spr_height=64,this.dt=200,this.maxcf=6,this.velocity_start=30,this.img=new Image}return _createClass(e,[{key:"load",value:function(){var e=this
return new Promise(function(t,i){var n=Date.now()
e.img.src="src/assets/spritesheets/raider.png",e.img.onload=function(){t(Date.now()-n)},e.img.onerror=function(){i()}})}}]),e}(),mec_default=new MeleeEnemyConstants,_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i]
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),MeleeEnemy=function(e){function t(e,i,n){_classCallCheck(this,t)
var s=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))
return s.spd=n,s.velocity_spd=s.spd/100,s.cf=0,s.dt_count=0,s.direction=0,s.body=new p2.Body({position:[e,i],mass:5,type:p2.Body.DYNAMIC,angle:0}),s.shape=new p2.Box({width:128,height:128,collisionGroup:Constants.GROUP_ENEMY,collisionMask:Constants.GROUP_PLAYER|Constants.GROUP_WALL}),s.body.addShape(s.shape),s}return _inherits(t,e),_createClass(t,[{key:"getKeyFrame",value:function(){return player.y<this.y?(this.previousY=this.upY,mec_default.upY):player.y>this.y?(this.previousY=this.downY,mec_default.downY):player.x<this.x?(this.previousY=this.leftY,mec_default.leftY):player.x>this.x?(this.previousY=this.rightY,mec_default.rightY):this.previousY}},{key:"update",value:function(e){this.dt_count=(e||1/60)+(this.dt_count||0),this.dt_count>=mec_default.dt&&(this.cf<mec_default.maxcf?this.cf++:this.cf=0,this.dt_count=0),player.x>=this.x&&(this.velocity[0]=mec_default.velocity_start),player.x<=this.x&&(this.velocity[0]=-mec_default.velocity_start),player.y>=this.y&&(this.velocity[1]=mec_default.velocity_start),player.y<=this.y&&(this.velocity[1]=-mec_default.velocity_start)}},{key:"draw",value:function(){Renderer.drawImage(mec_default.img,mec_default.spr_width*this.cf,this.getKeyFrame(),mec_default.spr_width,mec_default.spr_height,this.x-this.width/2,this.y-this.width/2,this.width,this.width)}},{key:"drawBoundingBox",value:function(){Renderer.drawShapeBoundingBox(this.shape,this.x,this.y,this.width,this.width)}},{key:"setX",value:function(e){this.body.position[0]=e}},{key:"setY",value:function(e){this.body.position[1]=e}},{key:"velocity",get:function(){return this.body.velocity}},{key:"x",get:function(){return this.body.position[0]}},{key:"y",get:function(){return this.body.position[1]}},{key:"width",get:function(){return this.shape.height}}]),t}(Enemy)
